{"title":"","uid":"f73a8e23e6f6f669cf99c7dba8fa0722","slug":"zookeeper/Zookeeper分布式锁","date":"2022-03-28T02:58:42.548Z","updated":"2022-03-28T02:58:42.616Z","comments":true,"path":"api/articles/zookeeper/Zookeeper分布式锁.json","keywords":null,"cover":null,"content":"<h3 id=\"Zookeeper分布式锁\"><a href=\"#Zookeeper分布式锁\" class=\"headerlink\" title=\"Zookeeper分布式锁\"></a>Zookeeper分布式锁</h3><h4 id=\"1-概念\"><a href=\"#1-概念\" class=\"headerlink\" title=\"1.概念\"></a>1.概念</h4><ul>\n<li>当我们在进行单机应用开发，涉及并发同步的时候，我们往往采用synchronized或者Lock的方式来解决多线程之间的代码同步问题，这时多线程的运行都是在一个JVM下，没有任何问题</li>\n<li>但是当我们的应用是分布式集群工作的情况下，属于多JVM的工作环境，跨JVM已经无法通过多线程锁的方式来解决同步问题</li>\n<li>那么就需要一种更加高级的锁机制，来处理<code>跨机器的进城之间的数据同步问题</code>—这就是分布式锁</li>\n</ul>\n<h4 id=\"2-Zookeeper分布式锁原理\"><a href=\"#2-Zookeeper分布式锁原理\" class=\"headerlink\" title=\"2. Zookeeper分布式锁原理\"></a>2. Zookeeper分布式锁原理</h4><ul>\n<li><p>核心思想：当客户端要获取锁，则创建节点，使用玩锁，则删除该节点</p>\n<ol>\n<li><p>客户端获取锁时，在lock几点下创建<code>临时顺序</code>节点。</p>\n</li>\n<li><p>然后获取lock下面的所有子节点，客户端获取到所有的子节点后，如果发现自己创建的子节点序号最小，那么就认为该客户端获取到了锁。使用完锁后，将该节点删除 </p>\n</li>\n<li><p>如果发现自己创建的节点并非lock所有子节点中最小的，说明自己还没有获取到锁，此时客户端需要找到比自己小的哪个节点，同事对其注册事件监听器，监听删除事件</p>\n</li>\n<li><p>如果发现比自己小的那个节点被删除，则客户端的Watcher会受到响应的通知，此时再次判断自己创建的节点是否是lock子节点中序号最小的，如果是则获取到了锁，如果不是则重复以上步骤继续获取到比自己小的一个节点并注册监听</p>\n</li>\n</ol>\n</li>\n</ul>\n","text":"Zookeeper分布式锁1.概念 当我们在进行单机应用开发，涉及并发同步的时候，我们往往采用synchronized或者Lock的方式来解决多线程之间的代码同步问题，这时多线程的运行都是在一个JVM下，没有任何问题 但是当我们的应用是分布式集群工作的情况下，属于多JVM的工作环...","link":"","photos":[],"count_time":{"symbolsCount":559,"symbolsTime":"1 mins."},"categories":[],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Zookeeper%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81\"><span class=\"toc-text\">Zookeeper分布式锁</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-%E6%A6%82%E5%BF%B5\"><span class=\"toc-text\">1.概念</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-Zookeeper%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%8E%9F%E7%90%86\"><span class=\"toc-text\">2. Zookeeper分布式锁原理</span></a></li></ol></li></ol>","author":{"name":"zniceya","slug":"zniceya","avatar":"https://image-1308272335.cos.ap-shanghai.myqcloud.com/image/20220211200943.jpeg","link":"/","description":"hexo,nicely,blog,aurora","socials":{"github":"https://github.com/znicelya","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/177279267"}}}},"mapped":true,"prev_post":{"title":"Hexo+Aurora+COS+CDN","uid":"50d103871956e893966b30af3d9ba8af","slug":"Hexo-Aurora-Cos-CDN","date":"9999-12-31T15:59:59.000Z","updated":"2022-03-28T02:58:33.491Z","comments":true,"path":"api/articles/Hexo-Aurora-Cos-CDN.json","keywords":null,"cover":[],"text":"Hexo+Aurora+COS+CDNGit安装 Windows 访问官网 https:&#x2F;&#x2F;git-scm.com&#x2F; 直接安装即可 若速度太慢可访问国内淘宝镜像 https:&#x2F;&#x2F;registry.npmmirror.com&#x2...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"Hexo","slug":"Hexo","count":1,"path":"api/categories/Hexo.json"},{"name":"Aurora","slug":"Hexo/Aurora","count":1,"path":"api/categories/Hexo/Aurora.json"},{"name":"Cos","slug":"Hexo/Aurora/Cos","count":1,"path":"api/categories/Hexo/Aurora/Cos.json"},{"name":"CDN","slug":"Hexo/Aurora/Cos/CDN","count":1,"path":"api/categories/Hexo/Aurora/Cos/CDN.json"}],"tags":[{"name":"hexo","slug":"hexo","count":1,"path":"api/tags/hexo.json"},{"name":"aurora","slug":"aurora","count":1,"path":"api/tags/aurora.json"},{"name":"cos","slug":"cos","count":1,"path":"api/tags/cos.json"},{"name":"cdn","slug":"cdn","count":1,"path":"api/tags/cdn.json"}],"author":{"name":"zniceya","slug":"zniceya","avatar":"https://image-1308272335.cos.ap-shanghai.myqcloud.com/image/20220211200943.jpeg","link":"/","description":"hexo,nicely,blog,aurora","socials":{"github":"https://github.com/znicelya","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/177279267"}}}}},"next_post":{"title":"Dubbo概述","uid":"9adf678be9c2159500d5600b4591ca91","slug":"Dubbo概述","date":"2022-02-27T04:20:21.000Z","updated":"2022-03-28T02:59:15.536Z","comments":true,"path":"api/articles/Dubbo概述.json","keywords":null,"cover":[],"text":"Dubbo概述1.背景-网站应用的演进随着互联网的发展，网站应用的规模不断扩大，常规的垂直应用架构已无法应对，分布式服务架构以及流动计算架构势在必行，亟需一个治理系统确保架构有条不紊的演进。 单一应用架构当网站流量很小时，只需一个应用，将所有功能都部署在一起，以减少部署节点和成本...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[{"name":"Dubbo","slug":"Dubbo","count":1,"path":"api/categories/Dubbo.json"}],"tags":[{"name":"Dubbo","slug":"Dubbo","count":1,"path":"api/tags/Dubbo.json"}],"author":{"name":"zniceya","slug":"zniceya","avatar":"https://image-1308272335.cos.ap-shanghai.myqcloud.com/image/20220211200943.jpeg","link":"/","description":"hexo,nicely,blog,aurora","socials":{"github":"https://github.com/znicelya","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/177279267"}}}}}}