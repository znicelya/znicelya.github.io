{"title":"Curator客户端的使用","uid":"a8c22f633376d2280e1292f7c6481c88","slug":"zookeeper/Curator客户端的使用","date":"2022-02-18T04:20:21.000Z","updated":"2022-02-18T06:08:13.286Z","comments":true,"path":"api/articles/zookeeper/Curator客户端的使用.json","keywords":null,"cover":"https://gitee.com/zniceya/picgo/raw/master/image/20220218140526.png","content":"<h3 id=\"Curator客户端的使用\"><a href=\"#Curator客户端的使用\" class=\"headerlink\" title=\"Curator客户端的使用\"></a>Curator客户端的使用</h3><h4 id=\"1-Curator介绍\"><a href=\"#1-Curator介绍\" class=\"headerlink\" title=\"1.Curator介绍\"></a>1.Curator介绍</h4><p>Curator是Netflix公司开源的一套zookeeper客户端框架，解决了很多Zookeeper客户端非常底层的细节开发工作，包括连接重连、反复注册Watcher和NodeExistsException异常等等。</p>\n<h4 id=\"2-Curator引入\"><a href=\"#2-Curator引入\" class=\"headerlink\" title=\"2.Curator引入\"></a>2.Curator引入</h4><pre class=\"line-numbers language-xml\" data-language=\"xml\"><code class=\"language-xml\">&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.curator&lt;&#x2F;groupId&gt;\n    &lt;artifactId&gt;curator-framework&lt;&#x2F;artifactId&gt;\n    &lt;version&gt;5.1.0&lt;&#x2F;version&gt;\n&lt;&#x2F;dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.curator&lt;&#x2F;groupId&gt;\n    &lt;artifactId&gt;curator-recipes&lt;&#x2F;artifactId&gt;\n    &lt;version&gt;5.1.0&lt;&#x2F;version&gt;\n&lt;&#x2F;dependency&gt;</code></pre>\n\n<h4 id=\"3-Curator配置\"><a href=\"#3-Curator配置\" class=\"headerlink\" title=\"3.Curator配置\"></a>3.Curator配置</h4><h5 id=\"3-1-WrapperZK\"><a href=\"#3-1-WrapperZK\" class=\"headerlink\" title=\"3.1 WrapperZK\"></a>3.1 WrapperZK</h5><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">import lombok.Data;\nimport org.springframework.boot.context.properties.ConfigurationProperties;\nimport org.springframework.stereotype.Component;\n\n&#x2F;**\n * TODO\n *\n * @author Nicely\n * @version 1.0\n * @since 2022&#x2F;2&#x2F;18 13:08\n *&#x2F;\n@Data\n@Component\n@ConfigurationProperties(prefix &#x3D; &quot;curator&quot;)\npublic class WrapperZK &#123;\n\n    private Integer retryCount;\n\n    private Integer elapsedTimeMs;\n\n    private String connectString;\n\n    private Integer sessionTimeoutMs;\n\n    private Integer connectionTimeoutMs;\n&#125;\n</code></pre>\n\n<h5 id=\"3-2-CuratorConfig\"><a href=\"#3-2-CuratorConfig\" class=\"headerlink\" title=\"3.2 CuratorConfig\"></a>3.2 CuratorConfig</h5><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">import org.apache.curator.framework.CuratorFramework;\nimport org.apache.curator.framework.CuratorFrameworkFactory;\nimport org.apache.curator.retry.RetryNTimes;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport javax.annotation.Resource;\n\n&#x2F;**\n * TODO\n *\n * @author Nicely\n * @version 1.0\n * @since 2022&#x2F;2&#x2F;18 13:13\n *&#x2F;\n@Configuration\npublic class CuratorConfig &#123;\n\n    @Resource\n    private WrapperZK wrapperZK;\n\n    @Bean(initMethod &#x3D; &quot;start&quot;)\n    public CuratorFramework curatorFramework()&#123;\n        return CuratorFrameworkFactory.newClient(\n                wrapperZK.getConnectString(),\n                wrapperZK.getSessionTimeoutMs(),\n                wrapperZK.getConnectionTimeoutMs(),\n                new RetryNTimes(wrapperZK.getRetryCount(),wrapperZK.getElapsedTimeMs())\n        );\n    &#125;\n&#125;\n</code></pre>\n\n<h4 id=\"4-Curator创建节点\"><a href=\"#4-Curator创建节点\" class=\"headerlink\" title=\"4. Curator创建节点\"></a>4. Curator创建节点</h4><ul>\n<li><p>持久节点</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">String path &#x3D; curatorFramework.create().forPath(&quot;&#x2F;curator-noe&#x2F;node1&quot;);</code></pre></li>\n<li><p>持久序号节点</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">curatorFramework.create().withMode(CreateMode.PERSISTENT_SEQUENTIAL).forPath(&quot;&#x2F;curator-noe&#x2F;node2&quot;, &quot;data&quot;.getBytes());</code></pre></li>\n<li><p>临时节点</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">curatorFramework.create().withMode(CreateMode.EPHEMERAL).forPath(&quot;&#x2F;temp&quot;);</code></pre></li>\n<li><p>临时序号节点</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">curatorFramework.create().withMode(CreateMode.EPHEMERAL_SEQUENTIAL).forPath(&quot;&#x2F;temp&#x2F;tmpnode1&quot;);</code></pre></li>\n<li><p>容器节点</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">curatorFramework.create().withMode(CreateMode.CONTAINER).forPath(&quot;&#x2F;container&quot;);</code></pre></li>\n<li><p>多级节点</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">curatorFramework.create().creatingParentsIfNeeded().forPath(&quot;&#x2F;parent-node&#x2F;node-sub1&quot;);</code></pre></li>\n</ul>\n<h4 id=\"5-获取节点内容\"><a href=\"#5-获取节点内容\" class=\"headerlink\" title=\"5. 获取节点内容\"></a>5. 获取节点内容</h4><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">byte[] bytes &#x3D; curatorFramework.getData().forPath(&quot;&#x2F;curator-noe&quot;);\nSystem.out.println(Arrays.toString(bytes));</code></pre>\n\n<h4 id=\"6-设置节点内容\"><a href=\"#6-设置节点内容\" class=\"headerlink\" title=\"6.设置节点内容\"></a>6.设置节点内容</h4><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">curatorFramework.setData().forPath(&quot;&#x2F;curator-noe&quot;, &quot;changed&quot;.getBytes());\nbyte[] bytes &#x3D; curatorFramework.getData().forPath(&quot;&#x2F;curator-noe&quot;);\nSystem.out.println(Arrays.toString(bytes));</code></pre>\n\n<h4 id=\"7-删除节点\"><a href=\"#7-删除节点\" class=\"headerlink\" title=\"7. 删除节点\"></a>7. 删除节点</h4><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">curatorFramework.delete().guaranteed().deletingChildrenIfNeeded().forPath(&quot;&#x2F;parent-node&quot;);</code></pre>\n\n\n\n","text":"Curator客户端的使用1.Curator介绍Curator是Netflix公司开源的一套zookeeper客户端框架，解决了很多Zookeeper客户端非常底层的细节开发工作，包括连接重连、反复注册Watcher和NodeExistsException异常等等。 2.Cura...","link":"","photos":[],"count_time":{"symbolsCount":"3.3k","symbolsTime":"3 mins."},"categories":[{"name":"zookeeper","slug":"zookeeper","count":5,"path":"api/categories/zookeeper.json"}],"tags":[{"name":"zookeeper","slug":"zookeeper","count":5,"path":"api/tags/zookeeper.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Curator%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">Curator客户端的使用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-Curator%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">1.Curator介绍</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-Curator%E5%BC%95%E5%85%A5\"><span class=\"toc-text\">2.Curator引入</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-Curator%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">3.Curator配置</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#3-1-WrapperZK\"><span class=\"toc-text\">3.1 WrapperZK</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#3-2-CuratorConfig\"><span class=\"toc-text\">3.2 CuratorConfig</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-Curator%E5%88%9B%E5%BB%BA%E8%8A%82%E7%82%B9\"><span class=\"toc-text\">4. Curator创建节点</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5-%E8%8E%B7%E5%8F%96%E8%8A%82%E7%82%B9%E5%86%85%E5%AE%B9\"><span class=\"toc-text\">5. 获取节点内容</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6-%E8%AE%BE%E7%BD%AE%E8%8A%82%E7%82%B9%E5%86%85%E5%AE%B9\"><span class=\"toc-text\">6.设置节点内容</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#7-%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9\"><span class=\"toc-text\">7. 删除节点</span></a></li></ol></li></ol>","author":{"name":"znicelya","slug":"znicelya","avatar":"https://gitee.com/zniceya/picgo/raw/master/image/20220211200943.jpeg","link":"/","description":"hexo,nicely,blog,aurora","socials":{"github":"https://github.com/znicelya","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"https://gitee.com/zniceya/picgo/raw/master/image/u=839977396,1548112407&fm=253&fmt=auto&app=138&f=JPEG","link":"https://space.bilibili.com/177279267"}}}},"mapped":true,"prev_post":{"title":"Hexo+Aurora+COS+CDN","uid":"50d103871956e893966b30af3d9ba8af","slug":"Hexo-Aurora-Cos-CDN","date":"9999-12-31T15:59:59.000Z","updated":"2022-02-14T09:26:52.776Z","comments":true,"path":"api/articles/Hexo-Aurora-Cos-CDN.json","keywords":null,"cover":[],"text":"Hexo+Aurora+COS+CDNGit安装 Windows 访问官网 https:&#x2F;&#x2F;git-scm.com&#x2F; 直接安装即可 若速度太慢可访问国内淘宝镜像 https:&#x2F;&#x2F;registry.npmmirror.com&#x2...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"Hexo","slug":"Hexo","count":1,"path":"api/categories/Hexo.json"},{"name":"Aurora","slug":"Hexo/Aurora","count":1,"path":"api/categories/Hexo/Aurora.json"},{"name":"Cos","slug":"Hexo/Aurora/Cos","count":1,"path":"api/categories/Hexo/Aurora/Cos.json"},{"name":"CDN","slug":"Hexo/Aurora/Cos/CDN","count":1,"path":"api/categories/Hexo/Aurora/Cos/CDN.json"}],"tags":[{"name":"hexo","slug":"hexo","count":1,"path":"api/tags/hexo.json"},{"name":"aurora","slug":"aurora","count":1,"path":"api/tags/aurora.json"},{"name":"cos","slug":"cos","count":1,"path":"api/tags/cos.json"},{"name":"cdn","slug":"cdn","count":1,"path":"api/tags/cdn.json"}],"author":{"name":"znicelya","slug":"znicelya","avatar":"https://gitee.com/zniceya/picgo/raw/master/image/20220211200943.jpeg","link":"/","description":"hexo,nicely,blog,aurora","socials":{"github":"https://github.com/znicelya","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"https://gitee.com/zniceya/picgo/raw/master/image/u=839977396,1548112407&fm=253&fmt=auto&app=138&f=JPEG","link":"https://space.bilibili.com/177279267"}}}}},"next_post":{"title":"Zookeeper客户端使用","uid":"0bdaded0df01ce59e401a378d6fd90c0","slug":"zookeeper/Zookeeper客户端使用","date":"2022-02-16T14:09:21.000Z","updated":"2022-02-16T14:56:50.006Z","comments":true,"path":"api/articles/zookeeper/Zookeeper客户端使用.json","keywords":null,"cover":null,"text":"Zookeeper客户端使用1.多节点类型创建 创建持久节点 create [node] 创建持久序号节点 create -s [node] 创建临时节点 create -e [node] 创建临时序号节点 create -e -s [node] 创建容器节点 create -c...","link":"","photos":[],"count_time":{"symbolsCount":742,"symbolsTime":"1 mins."},"categories":[{"name":"zookeeper","slug":"zookeeper","count":5,"path":"api/categories/zookeeper.json"}],"tags":[{"name":"zookeeper","slug":"zookeeper","count":5,"path":"api/tags/zookeeper.json"}],"author":{"name":"znicelya","slug":"znicelya","avatar":"https://gitee.com/zniceya/picgo/raw/master/image/20220211200943.jpeg","link":"/","description":"hexo,nicely,blog,aurora","socials":{"github":"https://github.com/znicelya","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"https://gitee.com/zniceya/picgo/raw/master/image/u=839977396,1548112407&fm=253&fmt=auto&app=138&f=JPEG","link":"https://space.bilibili.com/177279267"}}}}}}