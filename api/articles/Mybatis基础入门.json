{"title":"Mybatis基础入门","uid":"08f5f5d9db8ab1e437781b3952ec2b51","slug":"Mybatis基础入门","date":"2022-02-09T07:30:11.000Z","updated":"2022-02-12T06:44:36.593Z","comments":true,"path":"api/articles/Mybatis基础入门.json","keywords":null,"cover":"https://imgapi.cn/api.php?zd=zsy&fl=fengjing&gs=images","content":"<h2 id=\"1、Mybatis入门\"><a href=\"#1、Mybatis入门\" class=\"headerlink\" title=\"1、Mybatis入门\"></a>1、Mybatis入门</h2><h3 id=\"1-1导入依赖\"><a href=\"#1-1导入依赖\" class=\"headerlink\" title=\"1.1导入依赖\"></a>1.1导入依赖</h3><pre class=\"line-numbers language-xml\" data-language=\"xml\"><code class=\"language-xml\">&lt;dependency&gt;\n    &lt;groupId&gt;org.mybatis&lt;&#x2F;groupId&gt;\n    &lt;artifactId&gt;mybatis&lt;&#x2F;artifactId&gt;\n    &lt;version&gt;3.5.6&lt;&#x2F;version&gt;\n&lt;&#x2F;dependency&gt;</code></pre>\n\n<p>导入依赖之后我们可以先按照官网所示先做一个小的demo</p>\n<h3 id=\"1-2-编写配置文件\"><a href=\"#1-2-编写配置文件\" class=\"headerlink\" title=\"1.2 编写配置文件\"></a>1.2 编写配置文件</h3><ul>\n<li>第一步要使用Mybatis自然是需要Mybatis的配置文件了</li>\n</ul>\n<p>我们在src下的resources目录下新建一个Mybatis-config.xml文件</p>\n<pre class=\"line-numbers language-xml\" data-language=\"xml\"><code class=\"language-xml\">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot; ?&gt;\n&lt;!DOCTYPE configuration\n  PUBLIC &quot;-&#x2F;&#x2F;mybatis.org&#x2F;&#x2F;DTD Config 3.0&#x2F;&#x2F;EN&quot;\n  &quot;http:&#x2F;&#x2F;mybatis.org&#x2F;dtd&#x2F;mybatis-3-config.dtd&quot;&gt;\n&lt;configuration&gt;\n  \n&lt;&#x2F;configuration&gt;</code></pre>\n\n<p>xml文件里面需要Mybatis的约束，从官网上拿下来就可以了</p>\n<p>大家都知道与数据库连接是需要一个Connection的，当然现在我们使用Mybatis仍然是需要的，</p>\n<p>当然在Mybatis里面它为我们做了封装</p>\n<p>我们只需要一个叫SqlSession的对象就可以了</p>\n<p>但是我们知道要连接数据库则是需要数据源的</p>\n<p>我们可以配置在上面的Mybatis-config.xml文件中</p>\n<pre class=\"line-numbers language-xml\" data-language=\"xml\"><code class=\"language-xml\">&lt;environments default&#x3D;&quot;development&quot;&gt;\n        &lt;environment id&#x3D;&quot;development&quot;&gt;\n            &lt;transactionManager type&#x3D;&quot;JDBC&quot;&#x2F;&gt;\n            &lt;dataSource type&#x3D;&quot;POOLED&quot;&gt;\n                &lt;!--value&#x3D;&quot;$&#123;driver&#125;&quot;这种取值方式必须要读取properties文件--&gt;\n                &lt;!--我们可以通过在上面添加&lt;properties resource&#x3D;&quot;database.properties&quot;&#x2F;&gt;来读取properties文件--&gt;\n                &lt;property name&#x3D;&quot;driver&quot; value&#x3D;&quot;$&#123;driver&#125;&quot;&#x2F;&gt;\n                &lt;property name&#x3D;&quot;url&quot; value&#x3D;&quot;$&#123;url&#125;&quot;&#x2F;&gt;\n                &lt;property name&#x3D;&quot;username&quot; value&#x3D;&quot;$&#123;username&#125;&quot;&#x2F;&gt;\n                &lt;property name&#x3D;&quot;password&quot; value&#x3D;&quot;$&#123;password&#125;&quot;&#x2F;&gt;\n            &lt;&#x2F;dataSource&gt;\n        &lt;&#x2F;environment&gt;\n    &lt;&#x2F;environments&gt;</code></pre>\n\n<p>这里也附上database.properties文件</p>\n<pre class=\"line-numbers language-properties\" data-language=\"properties\"><code class=\"language-properties\">driver&#x3D;com.mysql.jdbc.Driver\nurl&#x3D;jdbc:mysql:&#x2F;&#x2F;xxxx:3306&#x2F;mybatis?useUnicode&#x3D;true&amp;characterEncoding&#x3D;utf-8&amp;useSSL&#x3D;false\nusername&#x3D;root\npassword&#x3D;123456</code></pre>\n\n<p>而我们需要知道的则是如何来拿到SqlSession对象并使用</p>\n<h3 id=\"1-3编写MybatisUtils工具类\"><a href=\"#1-3编写MybatisUtils工具类\" class=\"headerlink\" title=\"1.3编写MybatisUtils工具类\"></a>1.3编写MybatisUtils工具类</h3><ul>\n<li>如何拿到SqlSession并使用</li>\n</ul>\n<p>我们可以写一个工具类专门用于获取SqlSession对象</p>\n<p>首先我们通过看官网得知要使用SqlSession则必须有一个SqlSessionFactory对象来获取  </p>\n<p>通过看官网我们可以得知SqlSessionFactory对象则是由SqlSessionFactoryBuilder来获取的</p>\n<p>MybatisUtils文件放在下面</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">public class MyBatisUtils &#123;\n    private static SqlSessionFactory sqlSessionFactory;\n\n    static &#123;\n        InputStream inputStream &#x3D; null;\n        try &#123;\n            String resource &#x3D; &quot;Mybatis-config.xml&quot;;\n            inputStream &#x3D; Resources.getResourceAsStream(resource);\n            sqlSessionFactory &#x3D; new SqlSessionFactoryBuilder().build(inputStream);\n        &#125; catch (IOException e) &#123;\n            e.printStackTrace();\n        &#125;\n    &#125;\n\n    public static SqlSession getSqlSession()&#123;\n        return sqlSessionFactory.openSession();\n    &#125;\n&#125;</code></pre>\n\n<p>到这里为止我们已经可以拿到数据库链接对象了</p>\n<p>下面我们实现一个小小的查询功能</p>\n<h3 id=\"1-4实现查询功能\"><a href=\"#1-4实现查询功能\" class=\"headerlink\" title=\"1.4实现查询功能\"></a>1.4实现查询功能</h3><p>首先我们遵循MVC三层架构模式</p>\n<p>建立以下几个包</p>\n<p><img src=\"https://kuangstudy.oss-cn-beijing.aliyuncs.com/bbs/2021/03/06/kuangstudy2aadeb03-95e6-4d39-93fd-a7badf2bc17d.png\"></p>\n<p>并提前把数据库字段映射成实体类（pojo）</p>\n<p>我们需要建一个mapper（dao）包，在mybatis项目中我习惯使用mapper</p>\n<p>然后在mapper包下面新建一个UserMapper接口</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">public interface UserMapper &#123;\n&#x2F;&#x2F;    获取所有用户\n    List&lt;User&gt; getUserList();\n&#125;\n</code></pre>\n\n<p>按照我们以前的javaweb项目我们需要再建立一个UserMapper的实现类来实现它里面的方法</p>\n<p>而我们现在使用了Mybatis则不再需要实现类但我们需要一个UserMapper.xml来映射我们的UserMapper接口</p>\n<p>一般我们会把UserMapper.xml文件放在resources目录下</p>\n<pre class=\"line-numbers language-xml\" data-language=\"xml\"><code class=\"language-xml\">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot; ?&gt;\n&lt;!DOCTYPE mapper\n        PUBLIC &quot;-&#x2F;&#x2F;mybatis.org&#x2F;&#x2F;DTD Mapper 3.0&#x2F;&#x2F;EN&quot;\n        &quot;http:&#x2F;&#x2F;mybatis.org&#x2F;dtd&#x2F;mybatis-3-mapper.dtd&quot;&gt;\n&lt;mapper namespace&#x3D;&quot;fun.nicely.mapper.UserMapper&quot;&gt;\n\n    \n    \n&lt;&#x2F;mapper&gt;</code></pre>\n\n<p>注意在这里我们一定要指明这个mapper文件映射的是哪个接口也就是：namespace 命名空间</p>\n<p>然后我们需要在这个mapper文件中写上SQL语句</p>\n<pre class=\"line-numbers language-xml\" data-language=\"xml\"><code class=\"language-xml\">&lt;select id&#x3D;&quot;getUserList&quot; resultType&#x3D;&quot;fun.nicely.pojo.User&quot;&gt;\n        select * from user\n&lt;&#x2F;select&gt;</code></pre>\n\n<p>注意id一定要和接口里面的方法名一样，mybatis就是通过id来映射的方法</p>\n<p>而resultType则是接口里面的方法要返回的数据类型</p>\n<p><strong>最后</strong></p>\n<p>最后我们要把UserMapper.xml文件注册到Mybatis-config.xml文件中</p>\n<p>我们在Mybatis-config.xml文件最后加上</p>\n<pre class=\"line-numbers language-xml\" data-language=\"xml\"><code class=\"language-xml\">&lt;mappers&gt;\n        &lt;mapper resource&#x3D;&quot;UserMapper.xml&quot;&#x2F;&gt;\n&lt;&#x2F;mappers&gt;</code></pre>\n\n<h3 id=\"1-5测试\"><a href=\"#1-5测试\" class=\"headerlink\" title=\"1.5测试\"></a>1.5测试</h3><p>我们写一个方法测试一下</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"> @Test\npublic void test() &#123;\n    SqlSession sqlSession &#x3D; null;\n    try &#123;\n        sqlSession &#x3D; MyBatisUtils.getSqlSession();\n        UserMapper mapper &#x3D; sqlSession.getMapper(UserMapper.class);\n        List&lt;User2&gt; userList &#x3D; mapper.getUserList();\n        for (User2 user : userList) &#123;\n            System.out.println(user);\n        &#125;\n    &#125;catch (Exception e)&#123;\n        e.printStackTrace();\n    &#125;finally &#123;\n        if (sqlSession !&#x3D; null) &#123;\n            sqlSession.close();\n        &#125;\n    &#125;\n&#125;</code></pre>\n\n<p>测试结果<br><img src=\"https://kuangstudy.oss-cn-beijing.aliyuncs.com/bbs/2021/03/06/kuangstudydc28f463-ba2c-44d5-bad7-dde0acee462e.png\"></p>\n","text":"1、Mybatis入门1.1导入依赖&lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;&#x2F;groupId&gt; &lt;artifactId&gt;mybatis&lt;&#x2F;artifactId&gt; &lt;v...","link":"","photos":[],"count_time":{"symbolsCount":"4.8k","symbolsTime":"4 mins."},"categories":[{"name":"Mybatis","slug":"Mybatis","count":2,"path":"api/categories/Mybatis.json"}],"tags":[{"name":"Mybatis","slug":"Mybatis","count":2,"path":"api/tags/Mybatis.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1%E3%80%81Mybatis%E5%85%A5%E9%97%A8\"><span class=\"toc-text\">1、Mybatis入门</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-1%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96\"><span class=\"toc-text\">1.1导入依赖</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-2-%E7%BC%96%E5%86%99%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">1.2 编写配置文件</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-3%E7%BC%96%E5%86%99MybatisUtils%E5%B7%A5%E5%85%B7%E7%B1%BB\"><span class=\"toc-text\">1.3编写MybatisUtils工具类</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-4%E5%AE%9E%E7%8E%B0%E6%9F%A5%E8%AF%A2%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">1.4实现查询功能</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-5%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">1.5测试</span></a></li></ol></li></ol>","author":{"name":"zniceya","slug":"zniceya","avatar":"https://gitee.com/zniceya/picgo/raw/master/image/20220211200943.jpeg","link":"/","description":"hexo,nicely,blog,aurora","socials":{"github":"https://github.com/znicelya","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/177279267"}}}},"mapped":true,"prev_post":{"title":"工厂方法模式","uid":"a9afe666d8181b7b8b74143880e7533b","slug":"工厂方法模式","date":"2022-02-09T13:10:56.000Z","updated":"2022-03-28T02:58:33.103Z","comments":true,"path":"api/articles/工厂方法模式.json","keywords":null,"cover":"https://imgapi.cn/api.php?zd=zsy&fl=fengjing&gs=images","text":" 沉淀、分享、成长，让自己和他人都能有所收获！ 前言好看的代码千篇一律，恶心的程序升职加薪。 几乎是程序员就都知道或者了解设计模式，但大部分小伙伴写代码总是习惯于一把梭。无论多少业务逻辑就一个类几千行，这样的开发也可以归纳为三步；定义属性、创建方法、调用展示，Done！只不过开发...","link":"","photos":[],"count_time":{"symbolsCount":"3.2k","symbolsTime":"3 mins."},"categories":[{"name":"设计模式","slug":"设计模式","count":1,"path":"api/categories/设计模式.json"}],"tags":[{"name":"工厂方法模式","slug":"工厂方法模式","count":1,"path":"api/tags/工厂方法模式.json"}],"author":{"name":"zniceya","slug":"zniceya","avatar":"https://gitee.com/zniceya/picgo/raw/master/image/20220211200943.jpeg","link":"/","description":"hexo,nicely,blog,aurora","socials":{"github":"https://github.com/znicelya","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/177279267"}}}}},"next_post":{"title":"给网站加上鼠标点击烟花效果","uid":"95396110157e32674f9e9b0cbf309339","slug":"给网站加上鼠标点击烟花效果","date":"2022-02-05T09:22:11.000Z","updated":"2022-03-28T02:58:33.067Z","comments":true,"path":"api/articles/给网站加上鼠标点击烟花效果.json","keywords":null,"cover":"https://imgapi.cn/api.php?zd=zsy&fl=fengjing&gs=images","text":"给网站加上鼠标点击烟花效果 效果如图 具体实现 class Circle &#123; constructor(&#123; origin, speed, color, angle, context &#125;) &#123; this.origin &#x3D; origin...","link":"","photos":[],"count_time":{"symbolsCount":"5.4k","symbolsTime":"5 mins."},"categories":[{"name":"other","slug":"other","count":1,"path":"api/categories/other.json"}],"tags":[{"name":"other","slug":"other","count":1,"path":"api/tags/other.json"}],"author":{"name":"zniceya","slug":"zniceya","avatar":"https://gitee.com/zniceya/picgo/raw/master/image/20220211200943.jpeg","link":"/","description":"hexo,nicely,blog,aurora","socials":{"github":"https://github.com/znicelya","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/177279267"}}}}}}